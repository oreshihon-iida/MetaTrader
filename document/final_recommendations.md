# 複数時間足ボリンジャーバンド＋RSI戦略の最終改善提案

## 1. 概要

複数時間足ボリンジャーバンド＋RSI戦略の改善に向けた包括的なテストと分析を行いました。本文書では、テスト結果に基づく最終的な改善提案をまとめます。

## 2. テスト結果の要約

### 2.1 異なる戦略のパフォーマンス比較（2024-2025年）

| 戦略 | トレード数 | 勝率 (%) | プロフィットファクター | 純利益 (円) |
| --- | --- | --- | --- | --- |
| 元の戦略 | 14 | 42.86 | 0.63 | -29.51 |
| 複合指標・リスク管理強化版 | 5 | 20.00 | 0.38 | -4.39 |
| シンプル化・最適化版 | 7 | 42.86 | 不明 | 2.91 |

### 2.2 シンプル化・最適化版戦略の年別パフォーマンス

| 期間 | トレード数 | 勝率 (%) | プロフィットファクター | 純利益 (円) |
| --- | --- | --- | --- | --- |
| 2010 | 5 | 60.00 | 5.43 | 5.56 |
| 2024 | 4 | 0.00 | 0.00 | -5.79 |
| 2025 | 3 | 100.00 | inf | 8.70 |

## 3. 主な発見

1. **市場環境の変化**：2000-2020年で効果的だった戦略が2024-2025年では効果が低下している
2. **年による変動**：同じ戦略でも年によって大きくパフォーマンスが異なる（2024年と2025年の対照的な結果）
3. **シンプルさの効果**：複雑な指標やフィルターを追加するよりも、基本的なパラメータを最適化した方が良い結果が得られた
4. **トレード数の少なさ**：すべての戦略で2024-2025年のトレード数が少なく、統計的有意性に課題がある

## 4. 最終改善提案

### 4.1 シンプル化・最適化版戦略のさらなる改良

シンプル化・最適化版戦略は2024-2025年で唯一純利益がプラスになりましたが、さらに以下の改良を提案します：

```python
optimized_params = {
    'bb_window': 20,
    'bb_dev': 1.6,        # 1.5から微調整
    'rsi_window': 14,
    'rsi_upper': 75,      # 80から少し緩和
    'rsi_lower': 25,      # 20から少し緩和
    'sl_pips': 6.0,       # 5.0から少し拡大
    'tp_pips': 12.0,      # 10.0から少し拡大
    'atr_window': 14,
    'atr_sl_multiplier': 1.2,  # 1.0から少し拡大
    'atr_tp_multiplier': 2.4,  # 2.0から少し拡大
    'use_adaptive_params': True,
    'trend_filter': True,       # トレンドフィルターのみ有効化
    'vol_filter': False,
    'time_filter': True,        # 時間フィルターのみ有効化
    'use_multi_timeframe': True,
    'timeframe_weights': {'15min': 2.5, '1H': 1.0},  # 15分足の重みをさらに増加
    'use_seasonal_filter': False,
    'use_price_action': False,
    'consecutive_limit': 4,     # 5から少し厳格化
}
```

### 4.2 市場環境適応型パラメータの導入

市場環境を以下の4つに分類し、それぞれに最適なパラメータセットを用意します：

1. **トレンド相場**：
   - bb_dev: 1.8
   - rsi_upper: 75
   - rsi_lower: 25
   - timeframe_weights: {'15min': 1.5, '1H': 2.0}

2. **レンジ相場**：
   - bb_dev: 1.5
   - rsi_upper: 70
   - rsi_lower: 30
   - timeframe_weights: {'15min': 2.5, '1H': 1.0}

3. **高ボラティリティ相場**：
   - bb_dev: 2.0
   - rsi_upper: 80
   - rsi_lower: 20
   - timeframe_weights: {'15min': 1.0, '1H': 2.0}

4. **低ボラティリティ相場**：
   - bb_dev: 1.4
   - rsi_upper: 65
   - rsi_lower: 35
   - timeframe_weights: {'15min': 3.0, '1H': 1.0}

市場環境の判定には、ATR、ボリンジャーバンド幅、価格の方向性などを組み合わせた簡易的な分類ロジックを実装します。

### 4.3 リスク管理の最適化

シンプルながらも効果的なリスク管理手法を導入します：

1. **動的ポジションサイジング**：
   - 基本ロットサイズ：0.01
   - 最大リスク：口座残高の1.5%
   - 連続損失後のロットサイズ削減：2連敗後に50%削減

2. **適応型損切り・利確レベル**：
   - 基本損切り幅：6.0 pips
   - 基本利確幅：12.0 pips
   - ATRに基づく調整：ATR × 1.2（損切り）、ATR × 2.4（利確）
   - 最小リスク・リワード比：1.8

3. **エクスポージャー管理**：
   - 最大同時ポジション数：2
   - 最大ドローダウン制限：10%
   - 連続損失制限：3回

### 4.4 複合戦略の開発

単一の戦略ではなく、複数の戦略を組み合わせたポートフォリオアプローチを検討します：

1. **シンプル化・最適化版戦略**：基本戦略として使用
2. **トレンドフォロー型戦略**：トレンド相場で有効
3. **レンジ特化型戦略**：レンジ相場で有効

各戦略に資金を配分し、市場環境に応じて配分比率を動的に調整します。

## 5. 実装計画

1. **シンプル化・最適化版戦略の改良**（優先度：高）
   - パラメータの微調整
   - 選択的フィルターの適用
   - バックテストによる検証

2. **市場環境適応型パラメータの実装**（優先度：中）
   - 市場環境分類ロジックの開発
   - 環境別パラメータセットの定義
   - 動的パラメータ切り替えの実装

3. **リスク管理の最適化**（優先度：高）
   - 動的ポジションサイジングの実装
   - 適応型損切り・利確レベルの実装
   - エクスポージャー管理の実装

4. **複合戦略の開発**（優先度：低）
   - 追加戦略の開発
   - ポートフォリオ管理ロジックの実装
   - 統合バックテストの実行

## 6. 結論

複数時間足ボリンジャーバンド＋RSI戦略の改善に向けて、シンプル化・最適化版戦略をベースとした段階的な改良を提案します。市場環境の変化に適応できるよう、環境別パラメータの導入とリスク管理の最適化を優先的に実装することで、目標とする勝率70%以上、プロフィットファクター2.0以上の達成を目指します。

特に、2024-2025年の市場環境では、複雑な指標やフィルターよりも、基本的なパラメータの最適化と選択的なフィルター適用が効果的であることが示唆されました。今後は、より多くのトレード機会を生成しつつ、高い勝率を維持できるバランスの取れたパラメータ設定を探求していきます。
