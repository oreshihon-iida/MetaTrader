# 複数時間足ボリンジャーバンド＋RSI戦略の改善

本文書では、複数時間足ボリンジャーバンド＋RSI戦略の改善点と、2024-2025年データに対する最適化結果について説明します。

## 概要

複数時間足ボリンジャーバンド＋RSI戦略は、異なる時間足のシグナルを組み合わせることで、より信頼性の高いトレードシグナルを生成することを目的としています。本改善では、シグナル生成条件の最適化、季節性分析の導入、価格アクションパターンの活用、および動的パラメータ調整機能の強化を行いました。


## 時間足の組み合わせ検討

従来の戦略では15分足、1時間足、4時間足の3つの時間足を使用していましたが、シグナル生成条件が厳しすぎるという問題がありました。そこで、以下の時間足組み合わせを検討しました：

### 15分足 + 1時間足の組み合わせ
- 4時間足を除外し、15分足と1時間足のみを使用
- 時間足の重み付けを調整（15min: 1.0, 1H: 2.0）
- シグナル一致度の閾値を大幅に緩和（全重みの1%）

### 1時間足 + 4時間足の組み合わせ
- 15分足を除外し、1時間足と4時間足のみを使用
- 時間足の重み付けを調整（1H: 1.0, 4H: 2.0）
- シグナル一致度の閾値を大幅に緩和（全重みの1%）

テスト結果から、1時間足 + 4時間足の組み合わせがより多くのトレード機会（59トレード）を生成することがわかりましたが、勝率が低い（13.56%）という問題がありました。


市場の季節性パターンを活用するため、以下の季節性フィルターを実装しました：

- 曜日フィルター：土日を除外、月曜の朝と金曜の夕方を避ける
- 時間帯フィルター：深夜と早朝を避ける
- 月別フィルター：1月初旬と12月下旬を避ける


テクニカル指標だけでなく、価格アクションパターンも考慮するため、以下のパターン検出機能を追加しました：

- ピンバーパターン：下ヒゲ（買いシグナル用）と上ヒゲ（売りシグナル用）
- エンゲルフィングパターン：陽線と陰線のエンゲルフィング
- トレンド確認：短期的な価格トレンドの方向
- ボリンジャーバンドの位置関係
- RSIの極端な値


市場環境に応じてパラメータを動的に調整する機能を強化しました：

- ATR（Average True Range）に基づく損切り・利確レベルの調整
- 時間帯に応じた乗数の調整
- 曜日に応じた乗数の調整
- RSIの値に応じた乗数の調整
- ボリンジャーバンド幅に応じた乗数の調整


2024-2025年のデータに対して以下のパラメータを最適化しました：

- ボリンジャーバンド偏差：2.0 → 1.8（より狭いバンド）
- RSI上限：70 → 75（より極端な過買い）
- RSI下限：30 → 25（より極端な過売り）
- ストップロス：7.0 pips → 10.0 pips（より広いストップロス）
- テイクプロフィット：10.0 pips → 15.0 pips（より広いテイクプロフィット）
- ATR TP乗数：2.0 → 2.5（より大きな利益目標）


## 時間足組み合わせのテスト結果

### 15分足 + 1時間足（緩和条件）
- 総トレード数：2
- 勝率：0.00%（目標：70%以上）
- プロフィットファクター：0.00（目標：2.0以上）

### 1時間足 + 4時間足（緩和条件）
- 総トレード数：59
- 勝率：13.56%（目標：70%以上）
- プロフィットファクター：0.39（目標：2.0以上）
- 純利益：-222.21円

### 1時間足 + 4時間足（最適化条件）
- 総トレード数：44
- 勝率：34.09%（目標：70%以上）
- プロフィットファクター：0.79（目標：2.0以上）
- 純利益：-43.86円

最適化条件では以下のパラメータを使用：
- RSI上限：80（より極端な過買い）
- RSI下限：20（より極端な過売り）
- ボリンジャーバンド偏差：2.0
- ストップロス：15.0 pips
- テイクプロフィット：30.0 pips
- 連続シグナル制限：1
- 季節性フィルター：有効
- 価格アクションパターン：有効
- ボラティリティフィルター：有効

### 1時間足 + 4時間足（最終最適化条件）
- 総トレード数：14
- 勝率：42.86%（目標：70%以上）
- プロフィットファクター：0.63（目標：2.0以上）
- 純利益：-29.51円

最終最適化条件では以下のパラメータを使用：
- RSI上限：85（さらに極端な過買い）
- RSI下限：15（さらに極端な過売り）
- ボリンジャーバンド偏差：2.2（より広いバンド）
- ストップロス：15.0 pips
- テイクプロフィット：45.0 pips（より広いテイクプロフィット）
- 連続シグナル制限：1
- 季節性フィルター：有効
- 価格アクションパターン：有効
- ボラティリティフィルター：有効
- 月別フィルター：有効（勝率の低い月を除外）

最終最適化により、トレード数はさらに減少し、勝率は42.86%まで向上しましたが、まだ目標には達していません。

1時間足 + 4時間足の組み合わせは多くのトレード機会を生成しましたが、勝率とプロフィットファクターが目標を大きく下回っています。これは、条件を緩和しすぎたことによるものと考えられます。

## 改善方針

最適化テスト結果から、以下の追加改善方針を立てました：

1. **月別パフォーマンスに基づく季節性フィルターの強化**：
   - 勝率の高い月（2024年1月、8月、9月、2025年5月）に集中
   - 勝率の低い月（2024年5月、11月、12月、2025年1月、2月）を除外

2. **時間帯フィルターの精緻化**：
   - 時間帯ごとの勝率分析に基づくフィルター調整
   - 東京セッション、ロンドンセッション、NYセッションの重複時間帯に注目

3. **エントリー条件のさらなる厳格化**：
   - RSIの条件をさらに厳格化（買い：RSI < 15、売り：RSI > 85）
   - ボリンジャーバンドの乖離度をさらに重視
   - 価格アクションパターンの検出精度向上

4. **リスク・リワード比の最適化**：
   - テイクプロフィットをさらに広げる（30.0 pips → 45.0 pips）
   - リスク・リワード比を1:3に設定

5. **ボラティリティフィルターの調整**：
   - ATRに基づくボラティリティフィルターの閾値調整
   - 低ボラティリティ環境でのエントリー制限


1. **市場環境に応じた動的パラメータ調整の強化**：
   - ボラティリティ指標に基づくパラメータの自動調整
   - 市場フェーズ（トレンド/レンジ）の検出と適応

2. **時間帯フィルターの見直し**：
   - 時間帯ごとの勝率分析に基づくフィルター調整
   - タイムゾーンの考慮

3. **季節性分析の精緻化**：
   - 月間、週間、日内の季節性パターンの詳細分析
   - 経済指標発表前後の取引制限

4. **価格アクションパターンの検出精度向上**：
   - より複雑なパターンの追加（ダブルトップ/ボトム、ヘッドアンドショルダーなど）
   - パターン確認の条件調整


## 結論

複数時間足ボリンジャーバンド＋RSI戦略の改善により、2024-2025年のデータに対するパフォーマンスは向上しましたが、目標とする勝率70%とプロフィットファクター2.0には達しませんでした。

主な改善点と効果：
1. **時間足の組み合わせ最適化**：1時間足と4時間足の組み合わせが最も効果的
2. **シグナル生成条件の厳格化**：RSIの条件を厳しくし（15/85）、ボリンジャーバンド偏差を増加（2.2）
3. **リスク・リワード比の最適化**：テイクプロフィットを広げる（45.0 pips）
4. **季節性フィルターの導入**：勝率の低い月を除外
5. **価格アクションパターンの活用**：エントリー精度の向上

これらの改善により、勝率は初期の13.56%から42.86%まで向上し、トレード数は59から14に減少しました。純損失も-222.21円から-29.51円に改善されました。

今後は機械学習の導入や複合指標の開発など、より高度な手法を検討し、さらなるパフォーマンス向上を目指します。
