# FXトレードシステム 戦略分析と最適化

## 現在の戦略パターン

現在のFXトレードシステムでは、以下の2つの戦略を実装しています。バックテスト結果によると、現在の勝率は30%～51%の範囲です。将来的には勝率を70%程度まで向上させることを目標としています。

### 1. 東京レンジ・ロンドンブレイクアウト戦略

#### 概要
- 東京時間（9:00～15:00 JST）の価格レンジを記録
- ロンドン時間（16:00以降 JST）にそのレンジをブレイクした方向にエントリー
- 損切り幅：10pips
- 利確幅：15pips

#### 実装パラメータ
```python
class TokyoLondonStrategy:
    def __init__(self, sl_pips: float = 10.0, tp_pips: float = 15.0):
        self.sl_pips = sl_pips
        self.tp_pips = tp_pips
        self.name = "東京レンジ・ロンドンブレイクアウト"
```

#### エントリー条件
- 16:00 JST以降
- 高値ブレイクアウト（買い）：前の足が東京時間の高値を上回り、現在の足の前の終値が東京時間の高値以下
- 安値ブレイクアウト（売り）：前の足が東京時間の安値を下回り、現在の足の前の終値が東京時間の安値以上

### 2. ボリンジャーバンド＋RSI逆張り戦略

#### 概要
- ボリンジャーバンド2σ（±2σ）到達とRSIの条件が両方成立で逆張りエントリー
- 損切り幅：7pips
- 利確幅：10pips

#### 実装パラメータ
```python
class BollingerRsiStrategy:
    def __init__(self, sl_pips: float = 7.0, tp_pips: float = 10.0):
        self.sl_pips = sl_pips
        self.tp_pips = tp_pips
        self.name = "ボリンジャーバンド＋RSI逆張り"
```

#### エントリー条件
- 買い：価格がボリンジャーバンド下限（-2σ）を下回り、RSIが30未満
- 売り：価格がボリンジャーバンド上限（+2σ）を上回り、RSIが70超

#### テクニカル指標パラメータ
- ボリンジャーバンド：期間20、標準偏差2
- RSI：期間14

## バックテスト結果（2000-2025年）

### 年別パフォーマンス

| 年 | トレード数 | 総利益 (円) | 勝率 (%) | 初期残高 (円) | 最終残高 (円) | 年間リターン (%) |
|-----|------------|------------|----------|--------------|--------------|----------------|
| 2000 | 65 | -6 | 36.92 | 200,000 | 199,994 | -0.00 |
| 2001 | 105 | 6 | 42.86 | 200,000 | 200,006 | 0.00 |
| 2002 | 99 | -5 | 38.38 | 200,000 | 199,995 | -0.00 |
| 2003 | 99 | 18 | 47.47 | 200,000 | 200,018 | 0.01 |
| 2004 | 117 | 19 | 47.01 | 200,000 | 200,019 | 0.01 |
| 2005 | 130 | 1 | 40.77 | 200,000 | 200,001 | 0.00 |
| 2006 | 110 | 11 | 44.55 | 200,000 | 200,011 | 0.01 |
| 2007 | 118 | -17 | 34.75 | 200,000 | 199,983 | -0.01 |
| 2008 | 112 | 29 | 50.89 | 200,000 | 200,029 | 0.01 |
| 2009 | 122 | 4 | 41.80 | 200,000 | 200,004 | 0.00 |
| 2010 | 98 | -4 | 38.78 | 200,000 | 199,996 | -0.00 |
| 2011 | 108 | -2 | 39.81 | 200,000 | 199,998 | -0.00 |
| 2012 | 118 | -27 | 31.36 | 200,000 | 199,973 | -0.01 |
| 2013 | 137 | -8 | 37.96 | 200,000 | 199,992 | -0.00 |
| 2014 | 136 | 23 | 47.06 | 200,000 | 200,023 | 0.01 |
| 2015 | 119 | -20 | 33.61 | 200,000 | 199,980 | -0.01 |
| 2016 | 129 | -15 | 35.66 | 200,000 | 199,985 | -0.01 |
| 2017 | 136 | -35 | 30.15 | 200,000 | 199,965 | -0.02 |
| 2018 | 137 | -1 | 40.15 | 200,000 | 199,999 | -0.00 |
| 2019 | 128 | -9 | 37.50 | 200,000 | 199,991 | -0.00 |
| 2020 | 121 | -7 | 38.02 | 200,000 | 199,993 | -0.00 |
| 2021 | 115 | -19 | 33.91 | 200,000 | 199,981 | -0.01 |
| 2022 | 120 | -1 | 40.00 | 200,000 | 199,999 | -0.00 |
| 2023 | 127 | -18 | 34.65 | 200,000 | 199,982 | -0.01 |
| 2024 | 135 | -11 | 37.04 | 200,000 | 199,989 | -0.01 |
| 2025 | 57 | -5 | 36.84 | 200,000 | 199,995 | -0.00 |

### 主な統計

- **平均勝率**: 39.11%
- **最高勝率**: 50.89%（2008年）
- **最低勝率**: 30.15%（2017年）
- **平均トレード数**: 115.5トレード/年
- **平均利益**: -3.0円/年

## 戦略の改善案

現在の戦略の勝率を70%程度まで向上させるために、以下の改善案を検討します。

### 1. 東京レンジ・ロンドンブレイクアウト戦略の改善

#### パラメータ最適化
- **レンジ計算期間の調整**: 現在は9:00～15:00の東京時間全体を使用していますが、より狭い時間帯（例：10:00～14:00）に調整することで、より信頼性の高いレンジを形成できる可能性があります。
- **ブレイクアウト確認の強化**: 単純な価格ブレイクだけでなく、一定時間（例：2本の連続した陽線/陰線）のブレイクを確認することで、偽のブレイクアウトを減らせる可能性があります。
- **損切り・利確幅の最適化**: 現在の10pips/15pipsから、例えば8pips/16pipsなど、リスク・リワード比を改善する調整が考えられます。

#### フィルター追加
- **ボラティリティフィルター**: ATR（Average True Range）を使用して、ボラティリティが高すぎる/低すぎる日はエントリーを避ける。
- **トレンドフィルター**: 移動平均線などを使用して、トレンド方向と一致するブレイクアウトのみにエントリーする。
- **時間フィルター**: 特定の曜日や時間帯のパフォーマンスを分析し、成績の良い時間帯のみにエントリーを限定する。

### 2. ボリンジャーバンド＋RSI逆張り戦略の改善

#### パラメータ最適化
- **ボリンジャーバンドの調整**: 期間（現在20）や標準偏差（現在2）を調整して、より効果的なエントリーポイントを見つける。
- **RSIの閾値調整**: 現在の30/70から、例えば25/75に調整して、より極端な過買い/過売り状態でのみエントリーする。
- **損切り・利確幅の最適化**: 現在の7pips/10pipsから調整して、リスク・リワード比を改善する。

#### フィルター追加
- **トレンド確認**: 長期移動平均線との位置関係を確認し、トレンドに逆らわないようにする。
- **ダイバージェンス確認**: RSIとプライスアクションのダイバージェンスが発生している場合のみエントリーする。
- **ボラティリティ考慮**: ATRを使用して、ボラティリティに応じて損切り・利確幅を動的に調整する。

### 3. 新しい戦略の追加

#### 移動平均線クロス戦略
- 短期移動平均線（例：5期間）と中期移動平均線（例：20期間）のクロスでエントリー
- トレンドフィルターとして長期移動平均線（例：50期間）を使用

#### MACDダイバージェンス戦略
- MACDとプライスアクションのダイバージェンスを検出してエントリー
- RSIやストキャスティクスなどの他のオシレーターと組み合わせて確認

#### サポート・レジスタンス戦略
- 重要なサポート・レジスタンスレベルでのバウンスやブレイクアウトでエントリー
- フィボナッチリトレースメントレベルも考慮

## 次のステップ

1. **パラメータ最適化**: 現在の戦略のパラメータを様々に変更してバックテストを実行し、最適な組み合わせを見つける。
2. **フィルター追加**: 提案したフィルターを実装し、その効果を検証する。
3. **新戦略テスト**: 新しい戦略を実装してバックテストを行い、既存の戦略と比較する。
4. **戦略の組み合わせ**: 複数の戦略を組み合わせることで、より安定したパフォーマンスを目指す。
5. **リスク管理の改善**: ポジションサイジングや複数ポジションの管理方法を最適化する。

これらの改善を段階的に実施し、各ステップでバックテストを行いながら、勝率70%を目指して戦略を最適化していきます。
