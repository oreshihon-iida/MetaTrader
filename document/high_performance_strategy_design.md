# 高性能ボリンジャーバンド＋RSI戦略の設計

## 概要

本ドキュメントでは、勝率70%以上、プロフィットファクター2.0以上を目指した高性能ボリンジャーバンド＋RSI戦略の設計について説明します。この戦略は、既存の戦略を分析し、最適なパラメータと高度なフィルタリング手法を組み合わせることで、高い勝率とプロフィットファクターを実現することを目的としています。

## 主要な改善点

### 1. RSI閾値の厳格化（45/55）

- **目的**: シグナル品質の向上
- **実装**: RSIの買いシグナル閾値を45に、売りシグナル閾値を55に設定
- **効果**: 偽シグナルの削減と高品質シグナルの選別

### 2. ボリンジャーバンド幅の最適化（標準偏差1.6）

- **目的**: ノイズの削減とシグナル精度の向上
- **実装**: ボリンジャーバンドの標準偏差を1.6に設定
- **効果**: 適切なバンド幅によるシグナル品質の向上

### 3. リスク・リワード比の拡大（1:5）

- **目的**: プロフィットファクターの向上
- **実装**: 損切り幅2.5pips、利確幅12.5pipsに設定
- **効果**: 勝率が低くてもプロフィットファクターを高く維持

### 4. トレンドフィルターの強化

- **目的**: トレンドに逆らう取引の回避
- **実装**: 
  - 短期・中期・長期の移動平均線の位置関係を確認
  - 短期移動平均線の傾きを確認
- **効果**: トレンドに沿った取引のみを実行し、勝率向上

### 5. 時間フィルターの最適化

- **目的**: 高確率の時間帯に集中
- **実装**: 
  - アジア時間（0:00-6:00 UTC）とロンドン時間（8:00-16:00 UTC）に集中
  - 月曜日の最初の数時間と金曜日の最後の数時間を避ける
- **効果**: 市場の流動性が高く、予測可能性が高い時間帯に取引を集中

### 6. 市場環境適応型パラメータ

- **目的**: 異なる市場環境に適応
- **実装**: 
  - 4つの市場環境（通常、トレンド、ボラティリティ、レンジ）を検出
  - 各環境に最適なパラメータセットを適用
- **効果**: 市場環境の変化に動的に適応し、一貫したパフォーマンスを維持

### 7. 連続損失後のポジションサイズ削減

- **目的**: リスク管理の強化
- **実装**: 連続損失後はポジションサイズを50%に削減
- **効果**: ドローダウンの軽減と資金の保全

## 市場環境の検出と適応

### 市場環境の分類

1. **通常環境（Normal）**
   - 特徴: 平均的なボラティリティとトレンド強度
   - パラメータ: RSI 45/55, BB幅 1.6, SL/TP 2.5/12.5

2. **トレンド環境（Trending）**
   - 特徴: 強いトレンドが存在
   - パラメータ: RSI 40/60, BB幅 1.8, SL/TP 3.0/15.0

3. **高ボラティリティ環境（Volatile）**
   - 特徴: 平均を大きく上回るボラティリティ
   - パラメータ: RSI 35/65, BB幅 2.0, SL/TP 4.0/16.0

4. **レンジ環境（Ranging）**
   - 特徴: 狭いレンジでの値動き
   - パラメータ: RSI 48/52, BB幅 1.4, SL/TP 2.0/10.0

### 検出方法

- **ボラティリティ分析**: ATRの直近値と過去20期間の平均を比較
- **トレンド強度分析**: 移動平均線の傾きを計算
- **価格変動分析**: 直近の価格変動と価格レンジの比率を計算

## 価格アクションパターンの検出

### 買いシグナル用パターン

1. **3本連続の下落後の反転パターン**
   - 3本の連続した下落後に上昇キャンドルが出現
   - 反転の可能性が高い

2. **ピンバーパターン（下ヒゲが長い）**
   - 下ヒゲがボディの2倍以上
   - 下値の拒否を示す強いシグナル

3. **3本連続の下落**
   - 3本連続で下落
   - 過売り状態の可能性が高い

### 売りシグナル用パターン

1. **3本連続の上昇後の反転パターン**
   - 3本の連続した上昇後に下落キャンドルが出現
   - 反転の可能性が高い

2. **ピンバーパターン（上ヒゲが長い）**
   - 上ヒゲがボディの2倍以上
   - 上値の拒否を示す強いシグナル

3. **3本連続の上昇**
   - 3本連続で上昇
   - 過買い状態の可能性が高い

## 複数時間足分析

- **15分足**: 基本となる時間足（重み1.0）
- **1時間足**: 中期トレンドの確認（重み2.0）
- **4時間足**: 長期トレンドの確認（重み3.0）

長期時間足の重みを大きくすることで、長期トレンドに沿った取引を優先し、偽シグナルを削減します。

## 同時ポジション数と資金管理

- **最大同時ポジション数**: 5
- **基本ロットサイズ**: 0.01
- **勝率80%超時のロットサイズ**: 0.02
- **連続損失時のロットサイズ削減**: 50%（0.005）

## 期待される効果

- **勝率**: 70%以上
- **プロフィットファクター**: 2.0以上
- **年間純利益**: 100以上
- **最大ドローダウン**: 20%以下

## 今後の改善可能性

- **機械学習の導入**: 市場環境の自動分類と最適パラメータの予測
- **複合指標の開発**: RSI、ボリンジャーバンド、移動平均線などを組み合わせた複合指標
- **ニューラルネットワークによるパターン認識**: 価格アクションパターンの自動検出
- **ポートフォリオ最適化**: 複数通貨ペアへの分散投資
